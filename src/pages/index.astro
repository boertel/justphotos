---
import Layout from '../layouts/Layout.astro';
import Sidebar from '../components/Sidebar.astro';
import Logo from '../components/Logo.astro'
import Photo from '../components/Photo.astro'

const R2 = Astro.locals.runtime.env.R2;
const { objects } = await R2.list({ include: [ 'customMetadata' ], limit: 100 })
const photos = objects.map(object => {
  return {
    ...object.customMetadata,
    key: object.key,
    src: `/r2/${object.key}`
  }
})
---

<Layout title="Benjamin Oertel">
    <Sidebar>
        <Logo href="/" />
        <div class="flex flex-col p-4 gap-4">
            <h1 class="text-6xl font-title tracking-tighter">Benjamin Oertel</h1>
            <h2 class="text-muted flex items-center">
                <a href="/from/ben" class="hover:underline" tabindex="-1">@ben</a>
            </h2>
        </div>
    </Sidebar>
    <section class="sm:columns-1 md:columns-2 lg:columns-3 gap-4 p-4">
        {photos.map(photo => (
            <figure class="grid break-inside-avoid mb-4 relative group" style="grid-template-rows: 1fr auto;">
                <a href=`/${photo.key}` class="outline-2 focus:outline-primary outline-none outline-offset-0 outline-primary/0 transition-opacity">
                    <Photo src={photo.src} width={photo.width} height={photo.height} />
                </a>
                <!--figcaption class="absolute bottom-0 right-0 left-0 bg-black bg-opacity-50 text-xs text-white text-opacity-70 p-2">
                Caption
                </figcaption-->
            </figure>
        ))}
    </section>
</Layout>
